# AnkiSmart 产品开发路径文档

**文档版本**：1.3

**创建日期**：2026年2月10日

**作者**：Manus AI

## 1. 引言

本开发路径文档旨在为 AnkiSmart 项目提供一个高层次的开发规划和时间线。它将指导开发团队在不同阶段的工作重点，确保产品能够按计划交付，并逐步实现其愿景。

## 2. 开发阶段划分

AnkiSmart 的开发将分为以下几个主要阶段：

### 阶段一：核心功能开发 (MVP)

**目标**：实现产品核心价值，验证市场需求，发布最小可行产品 (MVP)。

**时间预估**：3个月

**主要任务**：

*   **环境搭建与基础架构**：
    *   PySide6 原生 Python 客户端框架搭建。
    *   明确前端技术路线：仅使用 PySide6，不采用 React 前端。
    *   Python + FastAPI 后端服务框架搭建。
    *   AnkiConnect API 集成与测试。
    *   本地配置管理模块开发（API Key 加密存储）。
*   **文档输入与转换模块开发**：
    *   文本格式输入支持：`ppt/pptx`、`doc/docx`、`txt`、`md`。
    *   文本格式直接转换为 Markdown（`md` 直接透传）。
    *   非文本格式统一转换为 PDF，再执行 OCR 并输出 Markdown。
    *   转换结果预览、编辑与质量校验 UI。
*   **LLM 模块开发**：
    *   集成 OpenAI API (GPT-4o) 进行 Markdown 到闪卡的提炼和生成。
    *   实现“问答对”和“完形填空”两种卡片生成策略。
    *   LLM 生成内容预览与微调 UI。
*   **Anki 对接模块**：
    *   实现牌组和笔记类型列表获取。
    *   实现卡片创建功能（推送到 Anki）。
    *   覆盖 Anki 官方支持的笔记类型与字段结构映射。
    *   完成 AnkiConnect 协议适配（`version: 6`、`result/error` 解析、可选 `key`）。
*   **用户界面 (UI/UX)**：
    *   设计简洁直观的 MVP 界面。
    *   实现快捷键配置功能。

**里程碑**：发布 AnkiSmart v1.0 (MVP)，具备多格式输入、统一 Markdown 流程、闪卡生成和 Anki 对接能力。

**阶段验收标准（DoD）**：

*   支持 `ppt/pptx`、`doc/docx`、`txt`、`md` 输入并稳定生成 Markdown。
*   非文本文件可走“PDF → OCR → Markdown”链路并完成任务状态追踪。
*   至少支持 `Basic`、`Cloze`、`Image Occlusion` 三类笔记类型写入 Anki。
*   AnkiConnect 协议适配完成（`version: 6`、`result/error`、可选 `key`）。
*   关键流程具备可观测性（traceId、阶段耗时、失败原因）。

### 阶段二：功能完善与性能优化

**目标**：根据用户反馈完善功能，提升用户体验和系统性能。

**时间预估**：2个月

**主要任务**：

*   **文档转换与 OCR 模块增强**：
    *   批量文件导入、转换与 OCR 流程编排。
    *   优化多语言识别准确率，特别是针对中文复杂排版。
    *   尝试集成 Google Cloud Vision API / Azure Read API 作为高级选项。
    *   优化 Markdown 结构保留（标题、列表、表格、段落层级）。
*   **LLM 模块增强**：
    *   增加“概念解释”卡片生成策略。
    *   优化 LLM 提示词工程，提高卡片生成质量和多样性。
    *   实现 OCR 错误自动纠正和内容润色功能。
    *   支持 DeepSeek API 集成。
*   **Anki 对接模块**：
    *   实现卡片更新功能。
    *   更完善的错误处理和用户反馈机制。
*   **性能优化**：
    *   优化文档转换、OCR 和 LLM 调用流程，减少响应时间。
    *   降低客户端资源占用。
    *   建立转换/OCR/LLM/Anki 写入链路的耗时监控与告警。
*   **用户界面 (UI/UX)**：
    *   提升界面美观度和交互流畅性。
    *   增加多语言界面支持。

**里程碑**：发布 AnkiSmart v1.1，提供更强大的 OCR 和 LLM 功能，更流畅的用户体验。

**阶段验收标准（DoD）**：

*   支持 Anki 官方内置笔记类型全覆盖映射。
*   文档标准化成功率达到目标值，失败回退策略可验证。
*   批量任务在异常场景具备重试、断点续跑与错误汇总能力。
*   完成转换/OCR/LLM/Anki 全链路监控看板与告警规则。

### 阶段三：高级功能与生态扩展

**目标**：引入高级功能，探索本地 LLM 集成，并考虑未来扩展。

**时间预估**：3个月

**主要任务**：

*   **本地 LLM 集成**：
    *   研究并集成 Ollama，支持用户在本地运行开源 LLM 模型。
    *   提供本地模型管理和配置界面。
*   **高级卡片类型支持**：
    *   研究并支持图像遮挡 (Image Occlusion) 卡片类型。
    *   研究并支持音频嵌入功能。
*   **智能学习辅助**：
    *   探索利用 LLM 自动构建知识图谱，展示知识点关联。
    *   提供学习建议或复习计划生成功能。
*   **用户反馈与社区**：
    *   建立用户反馈渠道和社区论坛。
    *   研究社区模板分享功能。

**里程碑**：发布 AnkiSmart v1.2，具备本地 LLM 支持和更多高级功能。

**阶段验收标准（DoD）**：

*   云端与本地 LLM 双路线可配置并可回滚。
*   高级卡片类型（含媒体字段）在主流 Anki 版本回归通过。
*   多平台可行性结论明确，输出迁移评估文档。

## 3. 技术栈与工具

| 类别         | 技术/工具                                    | 备注                                         |
| :----------- | :------------------------------------------- | :------------------------------------------- |
| **客户端框架** | PySide6                                      | 原生 Python 前端，桌面能力与 Python 生态一致 |
| **后端框架**   | Python + FastAPI                             | 统一编排 OCR、LLM 与 AnkiConnect             |
| **文档转换**   | 文本直转 Markdown + 非文本 PDF 中转          | 统一中间层为 Markdown                         |
| **OCR 引擎**   | PaddleOCR, Google Cloud Vision API, Azure Read API | 优先 PaddleOCR，云服务作为高级选项           |
| **LLM 引擎**   | OpenAI API, DeepSeek API, Ollama             | 云端和本地 LLM 结合，提供灵活性和隐私保护    |
| **Anki 对接**  | AnkiConnect (HTTP API)                       | 社区主流外部集成方式                         |
| **开发语言**   | Python (前端+后端)                           |                                              |
| **版本控制**   | Git                                          |                                              |
| **项目管理**   | Jira/Trello (或类似工具)                     |                                              |

## 4. 交付清单

*   **文档交付**：PRD、开发路径、接口说明、字段映射规范、错误码手册。
*   **功能交付**：输入转换、OCR、LLM 生成、Anki 写入、任务中心。
*   **质量交付**：单元测试、集成测试、端到端冒烟用例、性能基准报告。
*   **运维交付**：日志规范、监控指标、告警策略、问题排查手册。

## 5. 风险与挑战

*   **OCR 识别准确率**：尤其对于复杂排版、手写体或低质量图片，OCR 准确率可能影响用户体验。需要持续优化和引入更先进的引擎。
*   **LLM 生成质量**：LLM 生成内容的质量受模型能力、提示词工程和用户输入影响。需要不断迭代优化提示词，并提供用户微调机制。
*   **AnkiConnect 依赖**：AnkiSmart 依赖 AnkiConnect 插件，若用户未安装、未启动或配置不匹配（端口/API Key），会影响功能。
*   **格式转换一致性**：不同来源文档（Word/PPT/扫描件）转 Markdown 后的结构一致性与内容完整性需要重点保障。
*   **多进程协同复杂度**：PySide6 客户端与 Python 服务的进程管理、异常恢复、端口冲突处理需要重点设计。
*   **本地 LLM 部署**：本地 LLM 对用户硬件性能有要求，且模型管理和更新可能带来复杂性。
*   **用户隐私与数据安全**：确保用户数据在传输和存储过程中的安全性和隐私性。

## 6. 总结

AnkiSmart 的开发将是一个迭代和持续优化的过程。通过清晰的阶段划分和明确的任务目标，我们将逐步构建一个功能强大、用户友好的智能 Anki 闪卡制作工具，为用户的学习之旅提供强有力的支持。
